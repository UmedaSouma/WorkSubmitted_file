#include "enemy.h"
#include "player3D.h"

LPDIRECT3DTEXTURE9 CEnemy::m_pTexture = nullptr;

//========================================================================================================================
// コンストラクタ
//========================================================================================================================
CEnemy::CEnemy()
{
}

//========================================================================================================================
// デストラクタ
//========================================================================================================================
CEnemy::~CEnemy()
{
}

//========================================================================================================================
// 初期設定
//========================================================================================================================
HRESULT CEnemy::Init()
{
	// サイズを統一設定
	float size = 150.0f;
	SetSize({ size,size,size });

	SetType(CObject::ENEMY);	// タイプを設定

	// オブジェクト2Dの初期化を呼ぶ
	if (FAILED(CObject2D::Init()))
	{
		return E_FAIL;
	}

	// テクスチャの分割数を設定
	m_nTexSplit = { 1,1 };

	return S_OK;
}

//========================================================================================================================
// 終了処理
//========================================================================================================================
void CEnemy::Uninit()
{
	CObject2D::Uninit();
}

//========================================================================================================================
// 更新処理
//========================================================================================================================
void CEnemy::Update()
{
	CObject2D::Update();
}

//========================================================================================================================
// 描画処理
//========================================================================================================================
void CEnemy::Draw()
{
	CObject2D::Draw();
}

//========================================================================================================================
// 生成処理
//========================================================================================================================
CEnemy* CEnemy::Create(D3DXVECTOR3 pos)
{
	// cenemyのポインタを設定
	CEnemy* pEnemy = nullptr;
	pEnemy = new CEnemy;

	// 初期設定呼ぶ
	if (SUCCEEDED(pEnemy->Init()))
	{
		pEnemy->SetPos(pos);	// 位置
		pEnemy->BindTexture(m_pTexture);	// テクスチャ
	}	
	
	return pEnemy;
}

//========================================================================================================================
// テクスチャの読み込み
//========================================================================================================================
HRESULT CEnemy::TextureLoad()
{
	if (m_pTexture == nullptr)
	{
		CRenderer* Renderer = CManager::GetRenderer();
		LPDIRECT3DDEVICE9 pDevice = Renderer->GetDevice();

		D3DXCreateTextureFromFile(pDevice, "data\\TEXTURE\\fish_cardboard000.png", &m_pTexture);
	}
	return S_OK;
}

//========================================================================================================================
// テクスチャの破棄
//========================================================================================================================
void CEnemy::TextureUnLoad()
{
	if (m_pTexture != nullptr)
	{
		m_pTexture->Release();
		m_pTexture = nullptr;
	}
}